# CI для Java

Ваша задача настроить CI для имеющегося кода.

---

Код задания расположен в [репозитории](https://gitlab.akhcheck.ru/task-templates/task-ci-java-template).

Вы можете добавить код через `git remote add`, а можете и просто скопировать код в свой репозиторий. 

> Будьте аккуратны! Если сделаете `git clone` в своем репозитории, то получите результат отличный от желаемого. Почему? (Вспомните git)

---

## Общие требования

0. Задание следует выполнять на ветке `task-ci`. Создайте Merge Request из ветки `task-ci` в ветку `main/master`. Не забудьте перед отправкой проверить, что CI успешно проходит в Merge Request-е.

1. Должны быть реализованы 4 job-ы:
    - `checkstyle` внутри stage `lint` - запуск статического анализа кода,
    - `unit-tests` внутри stage `test` - запуск тестирования.
    - `build-artifact` внутри stage `package` - создание jar-архива.
    - `reports` внутри stage `report` - выгрузка различных отчетов

2. Если CI падает на стадии `lint`, то pipeline должен завершить работу сразу после этого.

3. Если CI падает на стадии `test`, то pipeline должен завершить работу сразу после этого.

4. Результаты тестов на стадии `test` должны быть выгружены непосредственно в GitLab. Подробнее можно посмотреть [здесь](https://docs.gitlab.com/ee/ci/testing/unit_test_reports.html).

5. На стадии `jar` должна быть лишь одна job, которая выгрузит jar-файл. Этот файл должен находиться **в корне** скачиваемого архива с артефактами сборки.

6. На стадии `report` должна быть лишь одна job, которая выгрузит все отчеты. Отчеты должны содержаться в папке `site`, лежащей **в корне** скачиваемого архива с артефактами сборки. (Директория `site` должна совпадать с одноименной, сгенерированной мавеном)

7. Pipeline должен успешно завершится. 


## Примечания

1. У команды `mvn` есть опция `-ntp`
2. Для того, чтобы CI начал исполняться надо указать Tag Gitlab Runner-а. Зайдите в настройки Gitlab Runner-ов в своем репозитории, чтобы узнать, какие именно tag-и поддерживаются.
3. В качестве образа можно использовать `maven:3.8.3-openjdk-17`
4. Статический анализ происходит во время фазы сборки Maven-проекта по имени `validate`.

## Критерии оценивания

- 0 баллов, если CI не собирается (дальнейшие стадии не оцениваются)
- 1.5 балла - если есть все перечисленные job-ы и stage-ы.
- 2.5 балла ставится,  если выгружены результаты тестов в GitLab в Pipeline-е.
- 3 балла ставится,  если правильно выгружен jar-файл, который правильно отрабатывает при запуске
- 3 балла ставится, если правильно выгружена работающая версия сайта.